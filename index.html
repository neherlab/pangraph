<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · PanGraph.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>PanGraph.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#User&#39;s-Guide"><span>User&#39;s Guide</span></a></li><li><a class="tocitem" href="#Citing-PanGraph"><span>Citing PanGraph</span></a></li></ul></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="tutorials/tutorial_1/">Building a pangraph</a></li><li><a class="tocitem" href="tutorials/tutorial_2/">The structure of Pangraph output file</a></li><li><a class="tocitem" href="tutorials/tutorial_3/">Polishing the pangraph and exploring alignments</a></li><li><a class="tocitem" href="tutorials/tutorial_4/">Projecting the graph on a subset of strains.</a></li><li><a class="tocitem" href="tutorials/tutorial_5/">Example application: plasmid rearrangements</a></li><li><a class="tocitem" href="tutorials/tutorial_6/">Example application: antibiotic resistance gene neighbourhoods</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="lib/pangraph/">PanGraph globals</a></li><li><a class="tocitem" href="lib/align/">Alignment</a></li><li><a class="tocitem" href="lib/block/">Blocks</a></li><li><a class="tocitem" href="lib/edge/">Edges</a></li><li><a class="tocitem" href="lib/graph/">Graphs</a></li><li><a class="tocitem" href="lib/gfa/">GFA</a></li><li><a class="tocitem" href="lib/mash/">Mash Implementation</a></li><li><a class="tocitem" href="lib/minimap/">Minimap2 Wrapper</a></li><li><a class="tocitem" href="lib/mmseqs/">MMseqs Wrapper</a></li><li><a class="tocitem" href="lib/node/">Nodes</a></li><li><a class="tocitem" href="lib/path/">Paths</a></li><li><a class="tocitem" href="lib/simulate/">Simulation</a></li><li><a class="tocitem" href="lib/utility/">Utility</a></li></ul></li><li><span class="tocitem">Command Line</span><ul><li><a class="tocitem" href="cli/build/">Build</a></li><li><a class="tocitem" href="cli/export/">Export</a></li><li><a class="tocitem" href="cli/generate/">Generate</a></li><li><a class="tocitem" href="cli/marginalize/">Marginalize</a></li><li><a class="tocitem" href="cli/polish/">Polish</a></li><li><a class="tocitem" href="cli/version/">Version</a></li></ul></li><li><span class="tocitem">Development</span><ul><li><a class="tocitem" href="dev/building-docker/">Building Docker image</a></li><li><a class="tocitem" href="dev/building-documentation/">Updating the documentation</a></li><li><a class="tocitem" href="dev/releasing/">Releasing</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/neherlab/pangraph/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="PanGraph"><a class="docs-heading-anchor" href="#PanGraph">PanGraph</a><a id="PanGraph-1"></a><a class="docs-heading-anchor-permalink" href="#PanGraph" title="Permalink"></a></h1><p>A <strong>fast</strong>, <strong>self-contained</strong> Julia library and command line tool suite to align multiple genomes into a pangenome graph.</p><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>Microbes don&#39;t evolve strictly by vertical descent and modification; in addition, there is persistent lateral exchange of genetic material within their local spatial neighborhood. At the present, explanatory population genetic models exist at both extrema of limits horizontal transfer rate; researchers have a reasonable, quantitative understanding of both asexual and the fully decoupled, single-site, evolution. However, there are currently no satisfactory models, and thus computational tools, in the more realistic intermediate regime, let alone that models which account for <em>any</em> structural variation within a population. In order to investigate such questions empirically in natural populations, we have developed a scalable multiple genome alignment tool, <strong>PanGraph</strong>, that identifies regions of mutual homology between large sets of closely related genomes. This is expected to be useful to parsimoniously infer horizontal gene transfer events within a community; perform comparative studies of genome gain, loss, and rearrangement dynamics; or simply to compress many related genomes.</p><p><strong>PanGraph</strong> (short for pangenome graph) builds a graph-based coordinate system for polymorphic variation in a microbial population that generalizes classical linear alignment techniques. The graph is built by progressively aligning pairs of genomes using Minimap2&#39;s minimizer-based algorithm, and thus simultaneously aligns all genomes within the population in linear time. The resultant graph represents contiguous intervals of homologous DNA as vertices and every genome as an ordered walk across such vertices. Edges of the graph are unordered and only exist if at least one genome was found to connect both vertices in either the forward or reverse strand. The documentation, and source code, uses the following terminology:</p><ol><li><strong>Block/PanContig:</strong>  A contiguous interval of sequence that compresses a linear multiple sequence alignment and represents a single vertex within a pangraph.  It is summarized by a consensus sequence, along with the polymorphisms needed for each genome to reconstruct the true sequence.</li><li><strong>Node:</strong>  An oriented traversal of a genome through a <em>block</em>, i.e. whether a given genome/duplication traverses a block along the forward or reverse direction.  One genome can have multiple nodes that point to the same <em>block</em>.</li><li><strong>Path:</strong>  A sequence of <em>nodes</em> that represent an ordered walk on the graph that reconstructs an input genome.  Can be circular or linear.</li><li><strong>Edge:</strong>  A juxtaposition/breakpoint between two <em>blocks</em> found in at least one genome.</li><li><strong>Graph/PanGraph:</strong>  A collection of <em>blocks</em>, associated to all recognized intervals of homology, and <em>paths</em>, genomes stored as an ordered walk of <em>nodes</em>.</li></ol><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>Pangraph is available:</p><ul><li>as a <strong>Julia library</strong></li><li>as a <strong>Docker container</strong></li><li>can be compiled into a <strong>binary</strong></li></ul><h3 id="as-a-Julia-library"><a class="docs-heading-anchor" href="#as-a-Julia-library">as a Julia library</a><a id="as-a-Julia-library-1"></a><a class="docs-heading-anchor-permalink" href="#as-a-Julia-library" title="Permalink"></a></h3><p>The library is written in and thus requires <a href="https://julialang.org/downloads/">Julia</a> to be installed on your machine. (Note: pangraph was developed in Julia v.1.7.2, compatibility with more recent versions is not guaranteed.)</p><p>To install pangraph as a julia library in a local environment:</p><pre><code class="language-bash hljs">    # clone the repository
    git clone https://github.com/neherlab/pangraph.git &amp;&amp; cd pangraph
    # build the package
    julia --project=. -e &#39;using Pkg; Pkg.build()&#39;</code></pre><p>The library can be accessed directly by entering the REPL:</p><pre><code class="language-bash hljs">    julia --project=.</code></pre><p>Alternatively, command-line functionalities can be accessed by running the main <code>src/PanGraph.jl</code> script:</p><pre><code class="language-bash hljs">    # example: build a graph from E.coli genomes
    julia --project=. src/PanGraph.jl build -c example_datasets/ecoli.fa.gz &gt; graph.json</code></pre><p>Note that to access the complete set of functionalities, the <a href="https://neherlab.github.io/pangraph/#Optional-dependencies">optional dependencies</a> must be installed and available in your <code>$PATH</code>.</p><h3 id="Using-Docker"><a class="docs-heading-anchor" href="#Using-Docker">Using Docker</a><a id="Using-Docker-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Docker" title="Permalink"></a></h3><p>Docker container image for PanGraph is available on Docker Hub: <a href="https://hub.docker.com/r/neherlab/pangraph">https://hub.docker.com/r/neherlab/pangraph</a></p><p><strong>1. Install Docker</strong></p><p>Install Docker as described on the official website: <a href="https://docs.docker.com/get-docker/">https://docs.docker.com/get-docker/</a></p><p>Optionally setup Docker so that it runs without <code>sudo</code> on Linux: <a href="https://docs.docker.com/engine/install/linux-postinstall/">https://docs.docker.com/engine/install/linux-postinstall/</a></p><p><strong>2. Pull a version of the PanGraph Docker image</strong></p><p>To obtain the latest released version, run:</p><pre><code class="language-bash hljs">    docker pull neherlab/pangraph:latest</code></pre><p>To obtain a specific version, for example <code>1.2.3</code>, run:</p><pre><code class="language-bash hljs">    docker pull neherlab/pangraph:1.2.3</code></pre><p>To obtain the latest development version (from <code>master</code> branch), run:</p><pre><code class="language-bash hljs">    docker pull neherlab/pangraph:master</code></pre><blockquote><p>⚠️ Note that the development versions can contain new and undocumented features, breaking changes and bugs. For most users, we recommend using either <code>:latest</code> or an explicit version.</p></blockquote><p><strong>3. Run PanGraph Docker container</strong></p><p>Issue <code>docker run</code> command:</p><pre><code class="language-bash hljs">    docker run --rm -it \
      --name &quot;pangraph-$(date +%s)&quot; \
      --volume=&quot;$(pwd):/workdir&quot; \
      --user=&quot;$(id -u):$(id -g)&quot; \
      --workdir=/workdir \
      neherlab/pangraph:latest \
      bash -c &quot;pangraph build --circular --alpha 0 --beta 0 /workdir/example_datasets/ecoli.fa.gz &gt; graph.json&quot;</code></pre><p>Replace the <code>:latest</code> tag with either an explicit version, e.g. <code>:1.2.3</code> or <code>:master</code>, depending on which version you pulled in the previous section. If you haven&#39;t run <code>docker pull</code>, the <code>docker run</code> command should pull the corresponding version for you.</p><p>Here we mount current directory <code>.</code> (expressed as absolute path, using <code>pwd</code> shell command) as <code>/workdir</code> into the container so that pangraph can read the local file <code>./example_datasets/ecoli.fa.gz</code> as <code>/workdir/example_datasets/ecoli.fa.gz&quot;</code>:</p><pre><code class="nohighlight hljs">                                 . -&gt; /workdir
    ./example_datasets/ecoli.fa.gz -&gt; /workdir/example_datasets/ecoli.fa.gz</code></pre><p>The <code>--name</code> flag sets the name of the container and the <code>date</code> command there ensures that a unique name is created on every run. This is optional. The <code>--rm</code> flag deletes the container (but not the image) after run.</p><p>Replace <code>:latest</code> with a specific version if desired. The <code>:latest</code> tag can also be omitted, as it is the default. </p><h3 id="Building-binaries-locally"><a class="docs-heading-anchor" href="#Building-binaries-locally">Building binaries locally</a><a id="Building-binaries-locally-1"></a><a class="docs-heading-anchor-permalink" href="#Building-binaries-locally" title="Permalink"></a></h3><p>PanGraph can be built locally on your machine by running (inside the cloned repo)</p><pre><code class="language-bash hljs">    export jc=&quot;path/to/julia/executable&quot; make pangraph &amp;&amp; make install</code></pre><p>This will build the executable and place a symlink into <code>bin/</code>.</p><p><strong>Importantly,</strong> if <code>jc</code> is not explicitly set, it will default to <code>vendor/julia-$VERSION/bin/julia</code>. If this file does not exist, we will download automatically for the user, provided the host system is Linux or MacOSX. Moreover, for the compilation to work, it is necessary to have <a href="https://mafft.cbrc.jp/alignment/software/">MAFFT</a> and <a href="https://github.com/soedinglab/MMseqs2">mmseqs2</a> available in your <code>$PATH</code>, see <a href="https://neherlab.github.io/pangraph/#Optional-dependencies">optional dependencies</a>.</p><p><strong>Note,</strong> it is <a href="https://julialang.github.io/PackageCompiler.jl/stable/#Installation-instructions">recommended by the PackageCompiler.jl documentation</a> to utilize the officially distributed binaries for Julia, not those distributed by your Linux distribution. As such, compilation may not work if you attempt to do so.</p><p><strong>Note,</strong> pangraph was developed in Julia v.1.7.2. Compatibility with more recent versions of Julia is not guaranteed.</p><h3 id="Optional-dependencies"><a class="docs-heading-anchor" href="#Optional-dependencies">Optional dependencies</a><a id="Optional-dependencies-1"></a><a class="docs-heading-anchor-permalink" href="#Optional-dependencies" title="Permalink"></a></h3><p>There are a few <strong>optional</strong> external programs that PanGraph can utilize<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>:</p><ol><li><a href="https://github.com/marbl/Mash">Mash</a> can be used to construct a guide tree in place of our internal algorithm (see <a href="https://neherlab.github.io/pangraph/cli/build/">build</a> command options).</li><li><a href="https://mafft.cbrc.jp/alignment/software/">MAFFT</a> can be optionally used to polish block alignments (see <a href="https://neherlab.github.io/pangraph/cli/polish/">polish</a> command). Only recommended for short alignments. </li><li><a href="https://github.com/soedinglab/MMseqs2">mmseqs2</a> can be used as an alternative alignment kernel to the default <em>minimap2</em> (see <a href="https://neherlab.github.io/pangraph/cli/build/">build</a> command options). It allows merging of more diverged sequences, at the cost of higher computational time.</li><li><a href="http://www.microbesonline.org/fasttree/">fasttree</a> is used to build phylogenetic trees for export in <a href="https://github.com/neherlab/pan-genome-analysis">PanX</a>-compatible format (see <a href="https://neherlab.github.io/pangraph/cli/export/">export</a> command options and the <a href="https://neherlab.github.io/pangraph/tutorials/tutorial_3/#Explore-block-alignments-with-the-panX-visualization">tutorial section</a>).</li></ol><p>In order to invoke all functionalities from PanGraph, these tools must be installed and available on <code>$PATH</code>.</p><p>If <a href="https://docs.conda.io/en/latest/">conda</a> is available, one can run the following command to install all of these dependencies in a new environment named <code>pangraph</code>:</p><pre><code class="nohighlight hljs">conda create -n pangraph -c conda-forge -c bioconda mmseqs2=13.45111 mash=2.2.2 mafft=7.475 FastTree=2.1.11</code></pre><p>Alternatively, a script <code>bin/setup-pangraph</code> is provided within the repository to install both dependencies for a Linux machine without access to root. It assumes GNU coreutils are available.</p><p>These dependencies are already available within the Docker container.</p><h2 id="User&#39;s-Guide"><a class="docs-heading-anchor" href="#User&#39;s-Guide">User&#39;s Guide</a><a id="User&#39;s-Guide-1"></a><a class="docs-heading-anchor-permalink" href="#User&#39;s-Guide" title="Permalink"></a></h2><p>Basic functionality of <strong>PanGraph</strong> is provided by a command line interface. This includes multiple genome alignment, the export of a genome alignment to various visualization formats, alignment polishing, and genome comparison tool. For more details please refer to the <strong>Tutorials</strong> section of the documentation.</p><p>Multithreading support is baked into the provided binary. Unfortunately, due to limitations in <em>julia</em>, the number of threads is set by the environment variable <code>JULIA_NUM_THREADS</code></p><p>For uncovered use cases, functionality can be added by utilizing the underlying library functions. Please see the high-level overview for definitions of library terminology.</p><h2 id="Citing-PanGraph"><a class="docs-heading-anchor" href="#Citing-PanGraph">Citing PanGraph</a><a id="Citing-PanGraph-1"></a><a class="docs-heading-anchor-permalink" href="#Citing-PanGraph" title="Permalink"></a></h2><p>PanGraph: scalable bacterial pan-genome graph construction. Nicholas Noll, Marco Molari, Liam P. Shaw, Richard Neher bioRxiv 2022.02.24.481757; doi: <a href="https://doi.org/10.1101/2022.02.24.481757">https://doi.org/10.1101/2022.02.24.481757</a></p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>We recommend <code>mmseqs</code> version <code>13-45111</code>, <code>mash</code> version <code>v2.2.2</code>, <code>MAFFT</code> version <code>v7.475</code> and <code>fasttree</code> version <code>2.1.11</code></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="tutorials/tutorial_1/">Building a pangraph »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Monday 30 October 2023 09:00">Monday 30 October 2023</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
